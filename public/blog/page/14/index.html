
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Hegel2011的博客</title>
  <meta name="author" content="Hegel 2011">

  
  <meta name="description" content="Split 一个分区有最多10次的限制。这跟实现的机制有关。当split发生时，是这么操作的： 将现有的PART# + 1， 名字保留为被拆分的partition
PART# - 1， 作为另一个partition的名字
再继续拆分的话，依照上面的分法持续划分。 所以10次以后， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://octopresszhangyu.herokuapp.com/blog/page/14/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Hegel2011的博客" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Hegel2011的博客</a></h1>
  
    <h2>读书 - 工作 - 生活 - 笔记</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:octopresszhangyu.herokuapp.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">关于自己</a></li>
  <li><a href="/blog/2014/03/02/to-read-list/">To-Read</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/05/10/oracle-partition-split-issues/">Oracle Partition Split Issues</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-05-10T13:41:00+08:00" pubdate data-updated="true">May 10<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Split 一个分区有最多10次的限制。这跟实现的机制有关。当split发生时，是这么操作的：</p>

<ol>
<li>将现有的PART# + 1， 名字保留为被拆分的partition</li>
<li>PART# - 1， 作为另一个partition的名字</li>
<li>再继续拆分的话，依照上面的分法持续划分。</li>
</ol>


<p>所以10次以后，就会出现这种错误<code>ORA-00001: unique constraint (SYS.I_TABPART_BOPART$) violated</code></p>

<p>自己值选的好一些，可以最多分成20个区。不过从实际情况来看，RAC似乎已经会自己relocate PART#。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/26/finance-notes/">非财务经理的财务课程</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-26T21:18:00+08:00" pubdate data-updated="true">Apr 26<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>参加公司组织的培训,记录一些心得.</p>

<p>雷士光电是一个三位创业者对财务目标产生偏差的典型案例.本来是3个同寝室的大学生共同创业,吴长江 / 胡永红 / 杜刚. 起初是胡和杜逼吴交出股权,
后来吴和供应商关系很好,最后逼迫胡和杜交出来股权, 合计一亿六千万.</p>

<p>财务会计是给股东/董事会/经营者 三个对象提供支持的.财务数据也可以公布给公共即第三方机构.</p>

<p>财务会计主要工作是对外, 管理会计主要是对内.</p>

<p>利益或风险全部的转移 &#8212;-> 入账时间.</p>

<p><strong>确认收入</strong>和<strong>收款</strong>是两个概念.目前主要实行权责发生制.可以后GD(elivery)N 和 GR(eceipt)N两种确认收入的方式.</p>

<p>四个基本概念:</p>

<ul>
<li>会计主体 Accounting entity, Business entity, AE必然是BE,但BE不一定是AE</li>
<li>持续经营 Going concern, 资产对经营活动有价值,主要指可以不断扩大的增长预期</li>
<li>会计分期 Perioicity, 每个地方不一样, 有的是1-12月,有的是4-3月</li>
<li>货币计量 Monetary measurement , 以同一种货币单位来计量</li>
</ul>


<p>分公司(<strong>Branch</strong>)是不能披露报表的,也就是非会计主体,无论是独立核算的还是非独立核算的分公司.<br/>
子公司(<strong>subsidery</strong>), 独立的法人主体, 是会计主体, 报表披露可能需要合并.</p>

<p>记账规则: <strong>有借必有贷, 有贷必有借</strong><br/>
公司记账的账户包括: 资产 / 负债 / 股本及权益<br/>
借贷其实就是 <strong>+-</strong></p>

<p>3张表:</p>

<ul>
<li>资产负债表</li>
<li>利润表</li>
<li>现金流表</li>
</ul>


<p>毛利 = 销售收入 - 销售成本<br/>
营业利润 = 毛利 - 期间费用 + 其他业务收入/支出(by-product)<br/>
税前利润 = 营业利润 + 投资收益 + 营业外收入/支出(如罚款/变卖资产)<br/>
净利润 = 税前利润 - 所得说</p>

<p>利润分配过程:</p>

<ul>
<li>利息 &#8212;> 债权人</li>
<li>税款 &#8212;> 税务局</li>
<li>股息 &#8212;> 股东</li>
<li>未分配利润 &#8212;> 扩大再生产</li>
</ul>


<p>收入确定 / 到款 / 坏账 / 计提的概念.<br/>
现代财务制度其实是以计提(accrual, accrue)为核心的, 可以通过计提实现坏账风险控制, 盈余管理, 加速资产折旧等.<br/>
计提是可以回退的,这样实际发生时就不难看了.而且可以有很多人为的判断在里面. 我们的年终奖其实就是以每月计提的方式,到年末发出来的.</p>

<p>关心销售收入就是关心总资产周转率.</p>

<p>杜邦分析法. 以净资产收益率为核心, 分解出来的一堆指数分析法.主要是关于利润/营业收入/权益系数的几组相关的指标.</p>

<p>标准成本法, 即按人头或其他标准统一规格地对成本进行计算.好处是方便做预算,方便大家沟通.<br/>
与之相应, 是作业成本法, 就需要按实际效用来进行计算.<br/>
二者其实可以相混.</p>

<p>呆滞货品报告, slow moving report.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/25/zaguosen2012/">查国生2012讲座</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-25T15:22:00+08:00" pubdate data-updated="true">Apr 25<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>又听到查老师的声音了。想当初在邯郸校区上研究生英语课的时候，就感觉这是一个好老师。爱学生，懂生活。后来知道他还是MBA
英语辅导的专家。听了几次讲座，幽默风趣依旧，体贴入微润物无声。听下来还是有一些收获：</p>

<ol>
<li>英语二机器阅卷，全部在上海进行阅卷，包含了一切专硕，20多万份</li>
<li>硕士普及不可能，本科都没普及好，所以几十年内不可能了，博士没意义，除非是教师、医生</li>
<li>MBA一线首选，二线（同济、财大）也可以考虑，再差的就没意义了</li>
<li>How to <strong>make more money</strong>. Better Money, Better Life.</li>
</ol>


<p>说的话让人信服的老师就是好老师。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/24/the-rails-view/">The Rails View</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-24T12:11:00+08:00" pubdate data-updated="true">Apr 24<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://pragprog.com/book/warv/the-rails-view">The Rails View</a>有pdf版。
是对View层实践的描述，可以认为是对rails的扩展。rails做的最好的还是model、controller这样用ruby写的，是靠强大的mc来
提高v的易写性。而在view层，还是可以有很多工作要做，很多实践经验可以总结。本书正是针对这个领域的作品。</p>

<p>(待续)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/23/arp-binding/">Arp 绑定</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-23T11:46:00+08:00" pubdate data-updated="true">Apr 23<span>rd</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>通过ftp备份老是报告登录失败。检查过后，网管告知我们是ip被抢。照理是需要网管执行纪律的，但是这个我就不越俎代庖，反正
解决问题为主。而且即便执行纪律也不保证下次就不会发生。于是想起来直接绑定arp和ip，这样可以<strong>根除</strong>此类问题。</p>

<p>主要参考了<a href="http://www.xxlinux.com/linux/article/network/security/20070809/9234.html">Linux下绑定IP和MAC地址，防止ARP欺骗</a>.</p>

<p>1.检查当前arp</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>root@ngntest ~<span class="o">]</span><span class="c"># arp -a</span>
</span><span class='line'>? <span class="o">(</span>192.168.203.22<span class="o">)</span> at 00:A0:D1:E5:D1:A9 <span class="o">[</span>ether<span class="o">]</span> on eth0
</span></code></pre></td></tr></table></div></figure>


<p>2.建立一个mac->ip的对应文件： ip-mac, 将IP和MAC写入才文件</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo</span> <span class="s1">&#39;192.168.202.19 00:26:b9:4c:8d:af&#39;</span> &gt; /etc/ip-mac
</span></code></pre></td></tr></table></div></figure>


<p>3.手动执行绑定</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="o">[</span>root@ngntest ~<span class="o">]</span><span class="c"># arp -f /etc/ip-mac</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>上面的内容也可以存入<code>/etc/rc.d/rc.local</code> ,这样可以实现开机自动绑定。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/19/heredocs/">Heredocs 和缩进</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-19T12:41:00+08:00" pubdate data-updated="true">Apr 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>heredocs是什么</h3>

<p><strong>heredocs</strong>适用于在代码中写一长串文档赋给变量的情形。标准的ruby heredocs是这样的</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">text</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="no">END</span>
</span><span class='line'><span class="sh">aaa</span>
</span><span class='line'><span class="sh">bbb</span>
</span><span class='line'><span class="sh">ccc</span>
</span><span class='line'><span class="no">END</span>
</span></code></pre></td></tr></table></div></figure>


<p>但是使用heredocs的时候常有<strong>时灵时不灵</strong>的情形，这个陷阱在于最后一行的缩进。默认情况下，END是必须顶格的，比如可以这样写</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Poem</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span>
</span><span class='line'>    <span class="vi">@text</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="no">END</span>
</span><span class='line'><span class="sh">&quot;Faith&quot; is a fine invention</span>
</span><span class='line'><span class="sh">When Gentlemen can see</span>
</span><span class='line'><span class="sh">But Microscopes are prudent</span>
</span><span class='line'><span class="sh">           In an Emergency.</span>
</span><span class='line'><span class="sh">(Emily Dickinson 1830-1886)</span>
</span><span class='line'><span class="no">END</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">recite</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="vi">@text</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>但是这样写就是<strong>不行</strong>了：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">text</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="no">END</span>
</span><span class='line'><span class="err">  aaa</span>
</span><span class='line'><span class="err">  bbb</span>
</span><span class='line'><span class="err">  END #END加了缩进就失败</span>
</span><span class='line'>  <span class="n">aaa</span>
</span><span class='line'>  <span class="n">bbb</span>
</span><span class='line'>  <span class="k">END</span> <span class="c1">#END加了缩进就失败</span>
</span></code></pre></td></tr></table></div></figure>


<h3>解决办法</h3>

<p>在第一个END前面加<code>-</code>，即使用<code>-END</code>，会让最后结束符<code> END</code>前的空白都被忽略，而<strong>内容前面的空白则会被保留</strong>。如果也要去掉，可以使用gsub.
此处END可以换成任意大写字符，只要成对匹配即可。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Poem</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span>
</span><span class='line'>    <span class="vi">@text</span> <span class="o">=</span> <span class="o">&lt;&lt;-</span><span class="no">END</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="sr">/^ {6}/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span><span class='line'><span class="sh">      &quot;Faith&quot; is a fine invention</span>
</span><span class='line'><span class="sh">      When Gentlemen can see</span>
</span><span class='line'><span class="sh">      But Microscopes are prudent</span>
</span><span class='line'><span class="sh">                 In an Emergency.</span>
</span><span class='line'><span class="sh">      (Emily Dickinson 1830-1886)</span>
</span><span class='line'><span class="no">    END</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">recite</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="vi">@text</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3><code>%w</code>是何方神圣</h3>

<p>有几次，我直接使用<code>%w{}</code>以为解决了这个问题。但实际上得到是一个Array。只不过Array.to_s又会获得和heredocs一样的效果，在使用ruby1.9的前提下。
%w要灵活方便的多吧，但这个确实不是heredocs，它只是数组。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">text2</span> <span class="o">=</span> <span class="sx">%w{</span>
</span><span class='line'><span class="sx">aaa</span>
</span><span class='line'><span class="sx">bbb</span>
</span><span class='line'><span class="sx">ccc</span>
</span><span class='line'><span class="sx">  dddd</span>
</span><span class='line'><span class="sx">      }</span>
</span><span class='line'>
</span><span class='line'><span class="nb">puts</span> <span class="n">text2</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="http://www.bitcetera.com/en/techblog/2009/07/02/heredoc-with-indent-in-ruby/">引用链接1</a></li>
<li><a href="https://github.com/styleguide/ruby">引用链接2</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/19/some-useful-link/">Ruby Inside 3月链接</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-19T11:23:00+08:00" pubdate data-updated="true">Apr 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>发现<a href="http://www.rubyinside.com/march-2012-ruby-news-5841.html?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+RubyInside+%28Ruby+Inside%29">Ruby Inside</a>最近的
文章又好看了起来。选了一些细细研究如下。</p>

<ul>
<li><p><a href="https://github.com/styleguide/ruby">GitHub&#8217;s Ruby Style Guide</a><br/>
很好的ruby编码规范，来自github，还澄清了我一些似是而非的概念。值得ruby学习者经常review。<br/>
此外，还有<a href="http://tomdoc.org/">tomdoc</a>做编码文档的规范，也需要进一步阅读。</p></li>
<li><p><a href="http://rubysource.com/zero-to-jekyll-in-20-minutes/">jekyll</a></p></li>
</ul>


<p>jekyll是一个输入markdown文件输出site的html的<strong>引擎</strong>。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>mkdir your_blog
</span><span class='line'><span class="nv">$ </span><span class="nb">cd</span> ./your_blog
</span><span class='line'><span class="nv">$ </span>mkdir _layouts _plugins _includes _posts css javascripts images
</span><span class='line'><span class="nv">$ </span>touch index.html _config.yml _layouts/default.html
</span></code></pre></td></tr></table></div></figure>


<p>目录树结构</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>├── README.md
</span><span class='line'>├── _config.yml
</span><span class='line'>├── _layouts
</span><span class='line'>  └── default.html
</span><span class='line'>├── _plugins
</span><span class='line'>├── _includes
</span><span class='line'>├── _posts
</span><span class='line'>│   ├── 2012-03-27-your_first_post_in_markdown.md
</span><span class='line'>│   └── 2012-03-27-your_second_post_in_textile.textile
</span><span class='line'>├── css
</span><span class='line'>│   └── screen.css
</span><span class='line'>├── javascripts
</span><span class='line'>├── images
</span><span class='line'>└── index.html
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>jekyll --server --auto
</span></code></pre></td></tr></table></div></figure>


<p>文档的要求只有一个:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>---
</span><span class='line'>layout: default
</span><span class='line'>title: Your First Post In Markdown
</span><span class='line'>---
</span></code></pre></td></tr></table></div></figure>


<p>就会按markdown里面的layout产生内容。</p>

<p>这样就可以明白octopress和jekyll的关系了。o是利用了jekyll做引擎，根据jekyll的目录要求加入了css、布局、图片等，同时还有.rb的一些插件，于是有了这个blog系统。而jekyll则还可以用来写书。道理也是一样的。自己设计layout，然后运行上面的命令即可。</p>

<ul>
<li><a href="http://spin.atomicobject.com/2012/02/28/load-balancing-and-reverse-proxying-with-nginx/">使用Nginx做分发的教程</a></li>
</ul>


<p>基本的内容都有了。而且还有利用nginx实现转发时使用basic验证和加Authorization的例子。</p>

<ul>
<li><a href="http://news.railstutorial.org/ruby-on-rails-tutorial-now-with-twitters-boot">配备了bootstrap的Rails教程</a></li>
</ul>


<p>Bootstrap 是一个优秀的CSS和UI框架，而这个正好是Rails所欠缺的。二者的结合将是威力巨大的。因为Rails可以解决开发中的
<strong>编码效率</strong>问题，但对<strong>界面美化</strong>却不能为力。而Bootstrap可以很好地弥补这一点。有点类似Jekyll和Octopress的关系。
<strong>结果</strong>都是可以让程序员和不具备界面美化能力的项目经理也可以设计出说得过去的应用。</p>

<ul>
<li><p><a href="http://patshaughnessy.net/2012/3/23/why-you-should-be-excited-about-garbage-collection-in-ruby-2-0">ruby 2.0 garbage collection</a></p></li>
<li><p><a href="http://addyosmani.com/blog/building-backbone-js-apps-with-ruby-sinatra-mongodb-and-haml/">building backbone js apps with ruby sinatra mongodb and haml</a></p></li>
</ul>


<p>全篇对backbone基本无介绍，火力集中在sinatra mongodb haml这些东西上了。文章的价值不大。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/19/taps-a-simple-app-to-transfer-data/">Taps： 一个导数据的工具</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-19T10:21:00+08:00" pubdate data-updated="true">Apr 19<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在railscast上看到了一个介绍导入导出数据的工具<a href="https://github.com/ricardochimal/taps">taps</a>.</p>

<p>最大的亮点在于:</p>

<ol>
<li>是用起服务的方式来完成。先针对一个数据库启动一个server监听在5000端口，随后在它处启动一个脚本导数据；</li>
<li>可以跨数据库导入导出。实际上中间是用到了<a href="sequel.rubyforge.org/">sequel</a>这个ruby的Orm框架，所以理论上应该是只要有adapter的数据库就都能被匹配。</li>
</ol>


<p>使用也非常之简单与直接</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>gem install taps
</span><span class='line'><span class="nv">$ </span>taps server postgres://localdbuser:localdbpass@localhost/dbname httpuser httppassword
</span><span class='line'><span class="nv">$ </span>taps pull postgres://dbuser:dbpassword@localhost/dbname http://httpuser:httppassword@example.com:5000
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/17/gimli-and-markdown-2-pdf/">Gimli and Markdown 2 Pdf</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-17T15:24:00+08:00" pubdate data-updated="true">Apr 17<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>想把博客部分文章转换成pdf，利于直接把文件分发。试了很多东西，包括 pandoc、little book 等等。
最终在这个法国人的<a href="http://kevin.deldycke.com/2012/01/how-to-generate-pdf-markdown/">博客</a>中找到了很好的解决办法。
最后因为安装了gimli，最终直接解决了格式、中文编码等各种问题。</p>

<p>先安装 Pandoc</p>

<p><code>sudo agt-get install pandoc nbibtex texlive-latex-base texlive-latex-recommended texlive-latex-extra preview-latex-style dvipng texlive-fonts-recommended</code></p>

<p>安装ruby的gem gimli</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo agt-get install wkhtmltopdf
</span><span class='line'>gem install gimli
</span></code></pre></td></tr></table></div></figure>


<p>最后运行</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>gimli -f ./README.md
</span></code></pre></td></tr></table></div></figure>


<p>即可得到类似GitHub风格的pdf文档。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/04/17/deployment-and-administration-for-mongod/">Learning Mongodb (3) 部署和管理</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-04-17T11:07:00+08:00" pubdate data-updated="true">Apr 17<span>th</span>, 2012</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>系列链接：</p>

<ol>
<li><a href="/blog/2012/03/29/learning-mongodb-1/">mongodb基础</a></li>
<li><a href="/blog/2012/03/30/learning-mongodb-2/">尝试分布式及复制  （sharding and replication)</a></li>
<li><a href="/blog/2012/04/17/deployment-and-administration-for-mongod/">部署和管理</a></li>
</ol>


<h3>部署环境要求</h3>

<ul>
<li><p>架构</p>

<ul>
<li><strong>64-bit</strong> , mongo会把所有的文件都map成虚拟地址空间，32位至多只能利用2GB内存空间</li>
<li>little-endian , 不适合SPARC, PowerPC, PA-RISC，客户端（驱动）无所谓运行环境</li>
</ul>
</li>
<li><p>CPU</p>

<ul>
<li>非cpu密集型应用</li>
<li>I/O瓶颈远比CPU瓶颈出现的可能性多</li>
<li>多客户端同时读时，多核会被利用</li>
<li>写操作还是单核</li>
</ul>
</li>
<li><p>RAM</p>

<ul>
<li>越多越好</li>
<li>working set， index size， ram总数</li>
</ul>
</li>
<li><p>Disk</p>

<ul>
<li>IOPS 优先</li>
<li><em>background flush</em> 60s sync到磁盘一次</li>
<li>ssd可以优化速度（solid state drive）</li>
<li>RAID 10 组成 LVM</li>
</ul>
</li>
<li><p>文件系统</p>

<ul>
<li>ext4 或者 xfs，快速、连续的磁盘分配</li>
<li>禁用access time(atime)更新</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># 禁用 atime更新</span>
</span><span class='line'>sudo mv /etc/fstab /etc/fstab.bak
</span><span class='line'>sudo vim /etc/fstab
</span><span class='line'><span class="c"># file-system mount type options dump pass</span>
</span><span class='line'><span class="nv">UUID</span><span class="o">=</span>8309beda-bf62-43 /ssd ext4 noatime 0 2
</span><span class='line'>
</span><span class='line'>改完文件后，可以不用重启
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>文件描述符(FD)

<ul>
<li>默认的1024不够用  <code>lsof | grep mongo | wc -l</code> 可以查看当前mongod打开了多少个文件和连接</li>
<li>调大 <code>ulimit -Hn</code> 可以查看</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>vi /etc/security/limits.conf
</span><span class='line'>mongodb hard nofile 10240
</span><span class='line'>下次登录后生效
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>时钟</p>

<ul>
<li>ntp协议，在跑shard和replication时候必须启用的东西</li>
</ul>
</li>
<li><p>ec2上使用mongodb</p>

<ul>
<li>ec2易用、地理范围广、价格有竞争力</li>
<li>68GB RAM的限制</li>
<li>使用  EBS 存储， 吞吐性能一般化</li>
</ul>
</li>
</ul>


<h3>服务器配置</h3>

<ul>
<li><p>选择拓扑</p>

<ul>
<li>是否需要shard， 是否需要replica</li>
<li>建议多机</li>
</ul>
</li>
<li><p>打开journal标志</p></li>
</ul>


<h3>安全保障</h3>

<ul>
<li><p>环境安全</p>

<ul>
<li>防火墙</li>
<li>数据的传输是不加密的</li>
</ul>
</li>
<li><p>授权</p>

<ul>
<li>给admin区增加用户<code>use admin; db.addUser("boss", "supersecret")</code></li>
<li>启动时带上选项 <code>mongod --auth</code></li>
<li>使用admin然后再授权 <code>use admin; db.auth("boss", "supersecret")</code></li>
<li>给其他库，如stock，创建用户 <code>use stocks; db.addUser("trader", "moneyfornuthin")</code></li>
<li>查找用户 <code>db.system.users.find()</code></li>
</ul>
</li>
<li><p>keyFile</p>

<ul>
<li>cluster 和 sharding 的时候需要制定keyFile，mongos实例也要具备这个密钥文件</li>
</ul>
</li>
<li><p>日志记录</p>

<ul>
<li>运行时&#8211;logpath指定</li>
</ul>
</li>
</ul>


<h3>监控工具</h3>

<ul>
<li><p>serverStatus<br/>
<code>use admin; db.runCommand({serverStatus: 1})</code><br/>
<strong>globalLock</strong> 表示等待写锁的时间。ratio过高意味着需要优化调整<br/>
<strong>mem</strong> 段的单位是MB</p></li>
<li><p>mongostat</p>

<ul>
<li>类似 iostat 运行的效果</li>
</ul>
</li>
<li><p>web console</p>

<ul>
<li>&#8211;rest 标志打开的话，可以从web处得到更多的运行信息</li>
</ul>
</li>
</ul>


<h3>备份与压缩</h3>

<p>mongodump 和 mongorestroe两个组合，也可以直接拷贝文件。不过后者要求lock数据库，即要求mongod停止往磁盘同步。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/15/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/13/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014/12/31/mac-shang-zhe-teng-ruby-2-dot-2/">Mac 上折腾Ruby 2.2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/28/springzhong-de-cron/">Spring中的CRON</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/21/tpp/">The Passionate Programmer</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/17/du-%5B%3F%5D-wu-er-zhe-ji-shu-wen-ti-%28-count-distinct%29/">独一无二者计数问题（ count-distinct）</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/12/11/bing-fa-de-abce-shi-he-xiao-yan-ma-dui-bing-fa-zhuang-kuang-chu-li-de-mang-qu/">并发的ab测试和校验码对并发状况处理的盲区</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/技术'>技术 (53)</a></li><li><a href='/blog/categories/生活'>生活 (34)</a></li><li><a href='/blog/categories/读书笔记'>读书笔记 (22)</a></li><li><a href='/blog/categories/时评'>时评 (22)</a></li><li><a href='/blog/categories/车车'>车车 (20)</a></li><li><a href='/blog/categories/神器'>神器 (19)</a></li><li><a href='/blog/categories/笔记'>笔记 (18)</a></li><li><a href='/blog/categories/ruby'>Ruby (13)</a></li><li><a href='/blog/categories/rails'>Rails (11)</a></li><li><a href='/blog/categories/java'>Java (11)</a></li><li><a href='/blog/categories/linux'>Linux (9)</a></li><li><a href='/blog/categories/软考'>软考 (8)</a></li><li><a href='/blog/categories/项目管理'>项目管理 (8)</a></li><li><a href='/blog/categories/云计算'>云计算 (6)</a></li><li><a href='/blog/categories/nodejs'>Nodejs (6)</a></li><li><a href='/blog/categories/nosql数据库'>Nosql数据库 (5)</a></li><li><a href='/blog/categories/spring'>Spring (5)</a></li><li><a href='/blog/categories/heroku'>Heroku (4)</a></li><li><a href='/blog/categories/旅游'>旅游 (3)</a></li><li><a href='/blog/categories/script'>Script (3)</a></li><li><a href='/blog/categories/sass'>Sass (2)</a></li><li><a href='/blog/categories/外刊'>外刊 (2)</a></li><li><a href='/blog/categories/期刊'>期刊 (2)</a></li><li><a href='/blog/categories/svn'>Svn (1)</a></li><li><a href='/blog/categories/git'>Git (1)</a></li><li><a href='/blog/categories/网络编程'>网络编程 (1)</a></li><li><a href='/blog/categories/测试'>测试 (1)</a></li><li><a href='/blog/categories/装机'>装机 (1)</a></li><li><a href='/blog/categories/安装'>安装 (1)</a></li><li><a href='/blog/categories/redis'>Redis (1)</a></li><li><a href='/blog/categories/mac'>Mac (1)</a></li></ul>
</section>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Hegel 2011 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <a title="Web Statistics" href="http://getclicky.com/66623321"><img alt="Web Statistics" src="//static.getclicky.com/media/links/badge.gif" border="0" /></a>
  <script src="//static.getclicky.com/js" type="text/javascript"></script>
  <script type="text/javascript">try{ clicky.init(66623321); }catch(e){}</script>
  <noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/66623321ns.gif" /></p></noscript>

</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
