
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Hegel2011的博客</title>
  <meta name="author" content="Hegel 2011">

  
  <meta name="description" content="Atom是Github投入开发的一个新编辑器。 目前只有Mac版，我在mbp上使用之后感觉还可以。基本可以认为是一个结合了Textmate和Vi插件的产物。
比如，看界面很像Textmate，但又有Textmat始终也没有支持的Ctrl-P插件。初步使用下来唯一不满的就是软件包太大， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://octopresszhangyu.herokuapp.com/blog/page/14/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Hegel2011的博客" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Hegel2011的博客</a></h1>
  
    <h2>读书 - 工作 - 生活 - 笔记</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:octopresszhangyu.herokuapp.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">关于自己</a></li>
  <li><a href="/blog/2015/02/20/to-read-list/">To-Read</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/07/atomhe-node-webkit/">Atom和Node-Webkit</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-07T16:21:00+08:00" pubdate data-updated="true">May 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://atom.io">Atom</a>是Github投入开发的一个<strong>新编辑器</strong>。 目前只有Mac版，我在mbp上使用之后感觉还可以。基本可以认为是一个结合了Textmate和Vi插件的产物。
比如，看界面很像Textmate，但又有Textmat始终也没有支持的Ctrl-P插件。初步使用下来唯一不满的就是软件包太大，170MB对于一个文本编辑器而言是很大了。毕竟Eclipse这样的IDE也只在200MB的规模。</p>

<p>在使用体验方面，比较起来，和Textmate更接近些，但扩展应该方便很多。而比起vi的话，主要优势在于是GUI的，支持command+s保存，也支持鼠标选取文本，对中文输入而言明显要比
vi更合适。高亮、快捷等简单用用差别并不大，美观度当然都可以配置的不错。</p>

<p>而在昨天，Atom进一步把他们的核心模块开源了，另外提到了他们是基于<a href="https://github.com/rogerwang/node-webkit/wiki">Node-Webkit</a> 开发的这款工具。</p>

<p>这个组合就让我有点费解了。因为webkit是一个当代浏览器的引擎，safari chrome chromium等都使用了webkit，可以理解webkit就是一个浏览器。而node是指的
Node.js，一个可以在服务器端编写javascript的平台，提供了很多的js库。而这么一个组合，干文本编辑器什么事情？在我开来，文本编辑器应该是很原生的一种应用软件。</p>

<p>仔细阅读了一下Node-Webkit的官方介绍以及一些其他材料，尤其是这篇<a href="http://blog.whattoc.com/2013/12/16/node-webkit01/">你所不知道的Node-webkit</a>
，忽然明白了所谓跑起来的Atom，其实就是运行了一个浏览器。只是这个浏览器里面的输入元素都是用HTML5编写的，而这个浏览器就是chromium，chrome的免安装的一个分支的名称。然后Atom又加了很多事件响应处理的注册代码段在里面。整个编辑类似于在线编辑，只是保存是在本地的。也因此，这个东西要往Linux和Windows迁移是轻而易举的。因为chromium和Node.js本来就是跨平台的。</p>

<p>然而，一旦有那么美好的事情，这个世界上就有银弹了。而历史的经验告诉我们，世上是没有银弹的。</p>

<p>Atom之所以在mbp上使用的体验还不错，主要是因为mbp搭载了大内存、ssd硬盘以及性能走在前列的x86处理器，所以并没有<strong>卡</strong>。而一旦这些条件不具备，情况就不是那么回事情了。这种类似phonegap，用浏览器来模拟原生应用的最大<strong>弱点</strong>无疑是性能差以及开销大。因此会有人提出打开大文件的效果不堪想象。<br/>
从口味上来讲，个人不太喜欢编辑器也Web化。虽然内存cpu的发展依然迅速，Atom的性能问题可能是可以被硬件性能的提升弥补的，但这种做法还是有其先天的缺陷。</p>

<p>所以，如果是脚本的开发，可能还是要继续用vi编写。如果是输入大量中文的话，Atom可以优先考虑。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/06/openssl-and-fipc/">Openssl and fIPC</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-06T14:27:00+08:00" pubdate data-updated="true">May 6<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Openssl还是一个关联很多的基础组件。自从爆出心血漏洞后，给自己的虚机也重新编译了一个新的openssl，
但是在编译ruby 2.1.1时却发现了新的问题。</p>

<p>第一个问题，是编译时老是认不出已经安装的openssl。可能因为openssl是从源码手工安装，而没有使用
apt-get intall，原因在于apt-get是失败的。</p>

<p>为解决这个问题，就在<code>/usr/loca/openssl-1.0.1g</code> 下独立编译生成了一个openssl。然后ruby再编译时可以识别openssl组件了。
但是，编译到一半，会报错</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>linking shared-object digest/md5.solibcrypto.a(md5_dgst.o): relocation R_X86_64_PC32 against undefined symbol</span></code></pre></td></tr></table></div></figure>


<p>错误具体是连接报错。建议是要编译时加上 <code>-fIPC</code> 的选项。初看起来有点摸不着头脑，到底是给ruby编译时加上还是给openssl加上呢？</p>

<p>这里就是遇到的第二个问题，连接共享库失败。</p>

<p>于是检查这个选项是什么意思。查下来后，我大致的理解是：</p>

<ol>
<li><code>fIPC</code>使得编译出来的库文件(.a, .so等)地址都是相对地址；</li>
<li>相对地址的好处是适合共享使用，但在装载时不同的进程可能会装载多次这个共享库；</li>
<li>如果没有此选项，则是按绝地地址来编译，好处是内存中只有一份。</li>
</ol>


<p>了解了fIPC是什么东西，上述报错就好理解了，是需要在openssl编译时加上此选项。</p>

<p><code>./config --prefix=/usr/local/openssl-1.0.1g -shared -fPIC</code> 然后<code>make &amp;&amp; make install</code></p>

<p>再在ruby安装包里执行</p>

<p><code>./configure --prefix=/home/user/.rbenv/versions/ruby-2.1.1 --disable-install-doc --with-openssl-dir=/usr/local/openssl-1.0.1g</code> , 然后 <code>make &amp;&amp; make install &amp;&amp; rbenv rehash</code></p>

<p>这样就装好了。</p>

<p>其实，我还有一点疑问，就是如何让openssl静态且又能找到。
估计又是一个属于和ubuntu紧密相关的问题。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/03/pu-lu-shi-bu-han-chuan-shuo/">普鲁士不含传说</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-03T15:47:00+08:00" pubdate data-updated="true">May 3<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>哈夫纳的名著之一，篇幅很短但内容很丰富，只读一遍肯定是不够的。
此书出版于2012年，国内的图书馆基本都还没货，所以是购买的台湾纸版书。
印刷和包装相对一般，价格倒是还好，折扣下来只有
300台币，折合60元人民币。</p>

<p>本书一如哈夫纳的风格，逻辑清晰、还原事实。去除了那些覆盖在普鲁士
身上的传说，而把普鲁士的崛起与特性追根溯源，来龙去脉介绍的十分
清晰。作为后天形成的理性国家，普鲁士有其巨大的优势，即人为组合而成，
因此其本身必须有许多的优点才能存活下来。为了生存，他具备了很多
先进的东西。比如法治、自由、不在乎以及最重要的&#8211;责任。国家对
公民尽责，公民对国家尽责，除此之外则公民爱干嘛就干嘛。这为他吸引
了大量的移民，使得这个国家在经济、军事上都保持了高于同时代国家的
活力。这也是普鲁士最吸引人的地方。</p>

<p>但是，普鲁士的弱点也在于此。因为他本身就是一个人为组合的国家，没有
民族和地理的基础，过的好时大家可以在一起，而过的不好或者可以用其他
方式过的更好时，他似乎就没有存在的必要了。这方面完全不如有民族或者
部族基础的国家。普鲁士作为一个国家，其结合点主要是霍恩佐伦家族，当
这个家族融入德意志之后，整个普鲁士也只能溶解于德意志了。</p>

<p>普鲁士的名称在历史上主要指向3个事物：</p>

<ol>
<li>生活在这片地区，丹泽到波罗的海沿岸，<strong>原始</strong>的部族。这部分人很早就被
灭族了。</li>
<li>原始部族是被<strong>条顿骑士</strong>殖民征服，并逐渐与西斯拉夫人融合，而征服者使用了被征服者的称呼。</li>
<li>由<strong>霍恩佐伦家族</strong>夹起来的地区性强权国家，条顿骑士团的最后一任大团长出自霍恩佐伦。第3个普鲁士即教科书里出现的普鲁士。</li>
</ol>


<p>其崛起充满了偶然性，也需要极大的运气，中间有着数个优秀但又性格迥异的君主。
比如，士兵国王，腓特烈大帝，以及他们的先辈和后代。其中，有的热衷于文化事业，
喜欢排场，有的则很节俭，有的则是军事天才。无论如何，他们都很有责任感，也
往往具备了坚强的毅力。</p>

<p>普鲁士其实打仗的时候并不多，即使是腓特烈大帝，所谓的欧洲最杰出的统帅之一，一生
大部分时间也是处理内政为主的，即便打也只是<strong>内阁战争</strong>。但普鲁士以善战闻名主要还是因为
不打则已，一打则往往是轰轰烈烈，而且常常伴随着惊人的胜利，交战双方也往往都要付出
极其惨重的代价。</p>

<p>普鲁士的崛起，离不开同<strong>俄罗斯</strong>的良好关系。这类似于近代东德和苏俄的关系。
腓特烈时代，普鲁士成为了一个<strong>双民族</strong>的<strong>大</strong>国家，国土的一半属于波兰并生活着
波兰人。但随着拿破仑横扫欧洲，普鲁士经历了巨大的考验。在反法同盟胜利后，其波兰
部分被去除，而得到了鲁尔区作为补贴。但在当时，这并不是一个划算的买卖。但也因祸得福，
普鲁士变成了德意志的单民族国家，鲁尔区后来成为最重要的煤产区和工业基地。反而摆脱了日后奥地利的命运。</p>

<p>三只老鹰即指，俄罗斯，普鲁士和奥地利。欧洲在德国崛起前，其实是波旁王朝（法国）和
哈夫斯堡王朝（奥地利）双雄争霸的格局。其后，才是俄罗斯和普鲁士崛起。普俄的关系在
1877年前都很好，之后因为土耳其退出了巴尔干，其遗产在英法奥俄间引起了巨大冲突，
才使得德俄关系进入了不良的阶段。直到现在也是如此。</p>

<p>随后，就是三场战争建立了一个国家，真正的日尔曼大国德意志。三场战争是普丹、普奥、普法，
杰出的政治家则是俾斯麦。而普鲁士军队的改革则是俾斯麦的领导，普鲁士国王完成的。国王
60多才即位，90高龄才离世。俾斯麦 毛奇均是他的选择。当然，他选择俾斯麦也多少有点无奈。</p>

<p>普鲁士的崛起也是符合顺应时代精神的结果。从腓特烈时代起，流行的是<strong>国家主义</strong>、<strong>民族主义</strong>,
这些东西塑造了整个近现代史。也有失败的主义运动，如<strong>种族主义</strong>。如果不符合时代精神，那么人为
怎么努力其结果必然还是要失败的。但这也意味着，爱国主义和爱民族主义其实并不是天经地义的。
实际上更早流行的是<strong>国王主义</strong>，国家只要有个国王就好了，曾经这个比民主二字还要吸引人。
我国其实一直是为<strong>国王</strong>服务的思想长期占据统治地位，现代化后逐步引入了国家、民族和民主，也算
一种进步吧。</p>

<p>普鲁士是一个伟大的国家，最后溶解于德国了。但普鲁士毕竟不是德国，溶解于德国未必是
他的领导人所希望的。只是普鲁士太人工合成了，所以一旦遇到德意志，就立马水乳交融了。
但有一点，普鲁士并不是一个扩张成性的国家，真的有着欧洲大国梦和传统的是奥地利，希特勒其实
是奥地利的传人，而绝不是腓特烈大帝、俾斯麦的继承者。</p>

<p>一国的崛起有其必然性，但运气的成分也是举足轻重的。普鲁士的辉煌绝对也离不开腓特烈的冒险。
做其他事情的道理也是类似的。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/02/macbook-pro/">Macbook Pro</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-02T11:24:00+08:00" pubdate data-updated="true">May 2<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>日本之旅买了很多东西，其中就包括了一台Macbook Pro。主要的参数如下：</p>

<p>屏幕: 13寸Retina<br/>
CPU: Intel Core i5 2.4GHz<br/>
Mem: 8GB 1600MHz<br/>
硬盘: 256GB SSD<br/>
显卡: Intel Iris Graphics<br/>
售价: 147800 日元，折合人民币9060</p>

<p>售价比中国便宜了许多主要是受汇率的影响。如果2月份去的话，会更便宜，现在
的汇率已经到0.061以上了。而最便宜的时候有几个礼拜都是在0.058左右浮动的。
当然，考虑到国内的售价是10788，所以便宜的幅度还是不小的。而且，Macbook是
可以在国内的苹果门店得到全球保修的。实际上除了iphone，苹果的所有产品均有
此项服务。</p>

<p>由于需要us版的键盘，所以只能放弃在<del>biccamera</del>之类的电器店购买mac。因为那边
只有日文键盘版的。太多的片假名让人不太喜欢，而且有些按键也和通常的布局不太一样。
而苹果店是同时有日文版和美国键盘版供应的。坏处有二：</p>

<ol>
<li>只能用visa，不能用银联；</li>
<li>电器店有5%的折扣+退税8%，而苹果店一般只有后者一个优惠，所以要贵5%。</li>
</ol>


<p>但为了完美一些，只能放弃5%的优惠了。这里还要再吐槽一下visa。用的卡是多币种的
信用卡，免去了1.5%的中间手续费，但visa的结算日期是按他们自己的节奏来的，不像
银联是当日汇率直接折算成人民币。而到visa的结算日，往往汇率对我们是不利的。所以，
对赚取人民币的人而言，用visa比银联要差的多。</p>

<p>严格说起来，这也是我人生中<strong>第一台笔记本</strong>。之前用过的主要是dell和ibm的
商务本，全部都是公司配的。这些机器虽然吐槽的人很多，我用下来一直感觉还算凑合。家里的一个sony本子是老婆婚前就
买的。所以，这台mac确实是我第一台自己购买的笔记本。</p>

<p>公司的电脑也很新，而且我目前也不考虑在工作中改用mac。家里有台式机也有一台昂贵的sony笔记本。
表面上看，我并不缺机器用。但有了孩子以后，能正经坐在台式机前的时间很少。而那台sony是
配ssd的，性能不错，但空间实在有限，装个虚机和基本的系统后，就没多少硬盘了。而且，我尤其
讨厌这台sony的屏幕，挺贵的机器，屏幕却配了一个永远想继续增加亮度的屏。也略微有点小重，
放在床上用并不舒服。<br/>
而mac就可以较好地解决这些问题了。为了写博客或者浏览信息基本不需要再装虚拟机。而mac的retina
屏幕实属人间尤物，细腻且亮度极高，一看就喜欢，越用越喜欢。机器本身只有1.5kg，比sony的小本子
还要轻一些。电池续航能力就更强了，号称可以有9个小时，而一般的本子能有4小时的已经算很强大了。
基于以上几个优点，轻、亮、长、匹配，使我相信macbook可以给我更多的在家使用电脑的机会。
而mac本身就是一个unix，意味着我在linux上常用的东西可以直接转到mac使用。实际上这台
mac竟然预装了ruby，而且还是2.0版本的ruby。尽管我还是会用rbenv，但对说明mac对开发人员
天生的友好支持则是足够了。</p>

<p>买回来之后，先注册一个apple id，登录好icloud, app store之后，就都是中文的东西了。
随后安卓xcode，安装homebrew(应该就是yehuda大神搞的那个东西吧)，基本上一个开发环境
就ok了。xcode里会自带git，brew则可以像yum apt-get一样安装各式的软件包。</p>

<p>随后，安装rbenv，ruby从1.8.7 1.9.3 2.1.1全部都装上，再装一个github的atom或者textmate
做编辑器，一个开发环境就绪了。输入法换成百度for mac。</p>

<p>（未完待续）</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/01/ri-ben-zhi-lu/">日本之旅</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-05-01T14:52:00+08:00" pubdate data-updated="true">May 1<span>st</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>时隔2年多又出国旅游了一次。这次旅行的地点是日本。</p>

<p>尽管中日关系略显紧张，但经济因素使得日本旅游方兴未艾。这次旅行同上次去意大利不同，
之前是跟团，这次因为准备的时间较充裕，所以选择了自己做攻略自由行的方式去游玩。
必须得感谢老婆，整个旅行的计划主要是她做的功课并成形的。</p>

<p>先说说对日本的总体感觉。其实应该说也只是局部的感觉，毕竟这次只是去了大阪 京都 奈良 东京几个地方，
但管中窥豹，形成印象已经足够了。概括起来，可以简要地变成下面几个关键词：</p>

<ol>
<li>干净</li>
<li>秩序</li>
<li>精细精确</li>
<li>先进</li>
<li>昂贵</li>
<li>物有所值</li>
</ol>


<p>整个日本是相当<strong>干净</strong>的，除了在奈良公园的土路上，我在那里呆了八九天，基本鞋子都是不沾灰的。衣服穿
2-3天依然还是相当的干净。在上海动不动就脏了，曾经以为是自己脏了，现在看来主要还是环境不干净。</p>

<p>日本的人很多，但并不让人觉得乱哄哄。整个社会极其有 <strong>秩序Â</strong> 和条理，也因此让人感觉足够的 <strong>安全</strong> 。
走在路上不用担心有人偷包，他们的超市或者药妆店也似乎根本不担心有贼的样子，马路上也没什么乱七八糟的
不稳定因素，十几年前的上海的治安也是远远不如的。至于各式的排队则更加有序了。顾客一般很自觉，即便
碰到不自觉的客户，服务人员也会坚持维护秩序，所以当地人基本没有破坏秩序的习惯，外来人员试了几次也就
习惯按日式规矩行事了。不像我们这边，客人就不说了，服务人员也不懂得在有人破坏秩序的时候他们是有义务
维护的，不然以后他们的工作只会越来越难越来越做的差。</p>

<p>受制于国土面积狭小同时又人口众多，日本人对任何东西控制的很  <strong>精细</strong>  可以说是被逼出来的。他们没有浪费的余地。
很多所谓的大寺，在中国可能只能被称作小庙了。但也因此，他们可以把小做精乃至做到极致，在服务水平方面，
这点尤其突出。同样的，在列车时间的精确性方面相信也很难有第二个国家能做到日本人的地步。</p>

<p>至于 <strong>先进性</strong> 则更是全方面的。从交通到建筑，到人的素质，到产品的品质，这个只有亲临过了
才能感受到。</p>

<p>所有的东西都是有代价的，日本达到上述优点同时也伴随着高物价。 <strong>昂贵</strong> 的物价是很令人震惊的。
尤其是谷物类和蔬菜类。那是上海的2-6倍了。而且味道并不怎么灵。同样是吃的，奶制品和巧克力等就和
我们很接近了。 日本的交通费也是很让中国人发指的。新干线500km要800元人民币了，速度还比我国的
高铁慢，而同样的距离我国只要200元左右就行了。整个高物价的代价就是他们的生活压力也很大，当然收
入肯定也很高，这样就更进一步会推高物价。</p>

<p>虽然东西很贵很贵，但一分价钱一分货，日本的东西倒也充分应验了这句话。最后让你觉得这一切还是物有所值的。
尤其是在上海的物价已经上升了很多之后。</p>

<h2>主要的行程</h2>

<p>第1天<br/>
大阪<br/>
关西机场、难波、海游馆</p>

<p>第2天<br/>
大阪<br/>
天守阁，历史博物馆，心斋桥、biccamer、苹果专卖店</p>

<p>第3天<br/>
大阪<br/>
环球影城、道顿崛</p>

<p>第4天<br/>
京都<br/>
京都站、清水寺、二年坂、三年坂</p>

<p>第5天<br/>
京都<br/>
岚山、嵯峨野观光小火车、天龙寺、锦市场、蟹道乐</p>

<p>第6天<br/>
奈良<br/>
近铁交通、春日大社、奈良公园</p>

<p>第7天<br/>
京都 东京<br/>
伏见稻荷大社、新干线、鸟元</p>

<p>第8天<br/>
东京<br/>
川崎、藤子F不二雄博物馆、三鹰吉卜力美术馆</p>

<p>第9天<br/>
东京<br/>
羽田机场、利木津机场巴士</p>

<p><a href="http://bbs.qyer.com/viewthread.php?tid=931893&amp;page=1&amp;extra=#pid9177702">旅游的详细链接</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/12/itxi-tong-jia-gou-de-mo-shi/">IT系统架构的模式</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-12T16:18:00+08:00" pubdate data-updated="true">Apr 12<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>近日终于得以拜读了Martin Fowler的大作《The Patterns of Enterprise Application Architecture》。</p>

<p>最早了解这本书是从robbin那里，在距今很多年前的一个Java书单里。彼时他对这本书的评价大意是适合要自己动手开发框架的人看，对应用开发没什么直接的帮助。同时，他认为读下来并没有太多感觉。而回过头来看，读过这本书的中国程序员应该是不少的，但真的从中汲取营养做出东西来的人几乎没有。从这也可以看出中国工程师在动手和创新方面确实有些先天不足。</p>

<p>然而，这本书对于DHH、对于Rails则可以说是一切的开端。对这本书贯彻的最到位、突破的最有力的，非DHH用Ruby开创Rails莫属。本书成书于2002年，彼时企业应用这个称呼比较时髦，按作者的说法，他的本意是IT系统的架构，而这也符合后来软件架构所适用的范围。如病人记录、订单跟踪、信用系统、保险、汇率兑换，这些都是IT系统，也就是企业应用。而文字处理、电梯控制、交换机、编译器、操作系统、游戏则基本不能算作企业应用。只是，2002年之后，企业应用这个名字被用的烂了，反而成了大慢笨的代表，导致07/08年的时候，甚至有不少人认为Rails不适合做企业应用。但彼时我感觉Rails对这些简单的所谓企业应用才是大杀器，毕竟大部分企业应用其实就是重度的CRUD应用，而这方面Rails堪比马克沁机枪对单兵的作战效果。至于互联网类的Web应用，交互、设计是占大头的，Rails投入使用的实际效果反而不如企业应用那么明显。</p>

<p>这本书确实是rails的设计指南，或者说是rails的设计文档。但DHH的突破和创新之处还是很明显的：</p>

<ol>
<li>本书是基于.Net 和 Java的，但提及了Python和Ruby，而作者更多的应该只是一种不抱希望的假设罢了，然而DHH真的用Ruby把这本书实作了出来。</li>
<li>虽然ActiveRecord取自于本书，然而作者本身并不是把这种模式看成一种自动化的ORM方案。广义的ORM，可以包含Dao(Table Gateway)、Data Transfer Object（json，xml）以及datamapper这些把记录化作内存对象所有模式，但狭义来看ORM是仅包含datamapper的。ActiveRecord在Fowler处其实只是一种Dao的变种。而DHH直接将ActiveRecord升格成了更高度自动化的ORM模式。</li>
<li>在视图层，坚决使用了Helper模式，未加入标签也未停留在scriplet阶段。</li>
</ol>


<p>对我而言，遗憾的一点是很晚才真的读了这本书，不知是喜是优的是因为晚读所以对这本书的内容很认可，而聊以自我安慰的是如果早读了说不定我也能
创造点什么东西，当然，最后一点纯属自娱自乐。<br/>
不过，这本书以及Rails，确实定义了过去10年Web开发的发展方向。因为Rails框架实际上已经成为了Web后台框架的一个标杆，
例如Spring MVC现在走的也是类似的道路。所以，这本书确实深深影响了Web应用的开发。</p>

<p>还有一点值得一提，就是这本书是真的基于Web总结的。很多模式的书籍，其实来源于客户端界面程序，比如从做菜单中提取出来的那些模式，而本书
是基于Web的，这就使得它和很多模式的书籍很不一样了。也因此，它才可以作为Rails的设计蓝图。而所有这些模式，大都来自于实践。实际上，
至今Rails也是Web开发优秀实践的最佳代表。而且Web开发的实践模式也不止书中提到的这些，实际上了解这些模式最好的方法就是接触Rails。虽然现在的模式比本书包含的更多了，本书依然很值得推荐阅读。</p>

<h2>笔记整理</h2>

<p>业务逻辑其实是业务反逻辑： complex business illogic</p>

<h3>分层的坏处</h3>

<ol>
<li>级联变更（Cascading Changes），就是改了一个地方往往要改n个地方</li>
<li>性能损害</li>
</ol>


<p>三层模型之所以能够流行，也是因为Web的流行。Client-Server工具中，是很难实现三层配置使用的。不过如今的App开发，好像也是三层模式。<br/>
但总体而言三层模型的流行是Web和Java等崛起的后果。</p>

<h3>常见的业务代码组织形式</h3>

<ul>
<li>Transaction Script</li>
<li>Domain Module , OO对TS的改变</li>
<li>Service层</li>
</ul>


<h3>会话状态</h3>

<ul>
<li>客户端 Cookie</li>
<li>服务端（内存）</li>
<li>共享服务端（数据库 Redis Memcache 共享文件夹）</li>
</ul>


<h3>分布式</h3>

<p>i
* 不要把不同的功能（对象）组件放在不同的服务器上，这样性能有问题
* 进程间只能尽量使用粗粒度接口，如N+1一次性读取同时返回很多信息
* 同一台服务器内部使用细粒度调用，远程外观模式<br/>
* Data Transfer Object ，传输对象，上面的那种是调用方法
* 同步的接口为主
* 异步的基于消息的处理方式
* 推动你思考而不是代替你思考，最终享受乐趣的是你，承担痛苦的也是你</p>

<h3>锁的种类</h3>

<ol>
<li>乐观锁，比如自己建立版本号；</li>
<li>悲观锁，就是常见的for lock；</li>
<li>粗颗粒（coarse-grainned)锁，就是一堆对象映射成一个入口，在入口处实施加锁；</li>
<li>隐含锁，把锁加到框架里，由Lock Manager和Lock Mapper来实现<strong>模板方法</strong>。</li>
</ol>


<h3>Stub和Mock</h3>

<p>Stub：用一个类直接替换某接口的实现，在测试或开发过程中使用这个替换类<br/>
Mock：用一个服务的重写来模拟某服务</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/12/ibmde-linuxhe-googlede-android/">IBM的Linux和Google的Android</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-12T16:18:00+08:00" pubdate data-updated="true">Apr 12<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>琢磨了一下Google当初为什么要推安卓，随手记之。起初感觉Google正在成为一个类似SUN的角色，而安卓就是Java。<br/>
二者的相似之处在于，java和安卓都给世界带来了很大的改变，借助这两样神器都出现了新的行业分支，如Java的企业应用、电商、网银等，安卓的出现才使得中国国产手机大幅度地进步，并在全球化的体系里占据更有优势的地位。但与此同时，不可否认的是，Google和SUN并未从中获得多少直接的收益。还有一点类似的地方，就是这两样神器也并不占用这两个巨头多少成本。相对于整个规模而言，无论是java还是安卓，对SUN或Google的成本比例都是有限的。</p>

<p>然而，转念一想，Google和SUN其实又是完全不一样的。SUN推广Java是希望卖更多的自己的硬件服务器，而且这个思路在90年代中期基本是可行的。而Google的服务现在如日中天，推广安卓确保了他在移动互联网时代（我更愿意称之为终端和使用人群进一步扩大的互联网时代）依然是搜索业务的王者。所以，仅就结果而言，Google是成功的，而SUN确实是被釜底抽薪了。</p>

<p>相比较而言，Google推安卓的动机和效果都更类似于90年代末IBM对Linux的扶持与推广。所欠缺的可能就是IBM没有收购Linux, Linus也没成立一个Linux的公司。<br/>
IBM借助Linux，抵挡的目标是M$，使得Windows难以在低端的PC服务器上一统江湖。而Google的安卓，则让智能手机避免了被Apple一家独占。而在此成功狙击的基础上，IBM和Google都继续卖着自己已经处于优势地位的服务。而再看SUN的话，当时的Java并无直接的竞争对手，后来的J2EE也是如此。SUN的目标比较单纯，推广Java只是为了可以让更多的公司做互联网的网络服务，而这必然需要更多的服务器。在PC Server+ Linux未流行的年代，Solaris是较低成本的一种选择。这个算盘其实打的还是不错的。但是，IBM大神对Linux的扶持，彻底让Sun的硬件找到了更廉价也更类似的替代品。当大部分用Java的企业，不去问Sun买Solaris服务器而是选择问IBM HP Dell买硬件、软件则直接使用Linux时，SUN的Java就真的只是当活雷锋了。可能IBM的本意未必是干掉SUN，只是希望M$不要也在服务器市场形成垄断，如同Google只是希望不要苹果在智能小型终端一统天下，但不可避免地误伤了SUN。当然，SUN的倒掉肯定还有其他更重要的因素，毕竟竞争和替代品是市场经济下每个个体和公司都面临的现实。</p>

<p>而IBM和Google的举动，毫无疑问都是成功了。IBM的PC服务器业务虽然卖给了联想，但至少也风光了十几年，而服务则继续在大卖。如果当初M$用windows统一了PC Server，那恐怕IBM现在也没服务好卖了。Google则在移动互联网时代，继续当着搜索的领袖，苹果在无法一统江山的情况下，也只能让Google继续保持是最重要的终端搜索引擎。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/04/07/xiao-mi-de-hong-mi/">小米的红米</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-07T16:17:00+08:00" pubdate data-updated="true">Apr 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>尽管红米电信版在小米网站是一直没抢到，但在电商的站点倒有不少已经上市的，只是贵200左右，为了赶上老妈的生日，还是直接去电商渠道购买了。</p>

<p>中间还有个插曲。原本是想在京东定的，然后要定了京东告知上海缺货。而在苏宁，反而发现还比京东便宜100，只要899. 当然，比小米官方的原价却又贵了100.但这个不用抢，就不是期货更不是神话了。</p>

<p>机器确实很新，3月底才新鲜出炉的。但拿到手后不得不有下面一些吐槽：</p>

<ol>
<li>cdma卡槽标记不明显。打开机盖后，只在很不显眼的地方能看见很小的cdma和gsm字样，除非凑到10公分以内，不然很难看清楚哪个是gsm哪个是cdma的卡槽。而且，在说明书上是完全没有标识的。</li>
<li>部分卡识别不出来，虽然是标准卡但可能还是要换卡。手头两张大卡uim，只能识别一张，于是不得不去营业厅花20换卡。要知道，我之前用努比亚z5s，虽然只能插小卡，但自己剪了一下就能用。而这个虽然也是大卡，但却不能用。想想也挺讽刺的。网上查了一下，这个也不是个案。可能只能说uim卡的标准比较古怪吧。好在换了2014版的uim卡也能认。</li>
<li>后盖很难开。这个可能习惯了就好。不过对于一个可以更换电池板的手机而言，确实不太方便。</li>
</ol>


<p>其他其实还有一些细节方面还是可以改进的。往好处想，小米其实还有提升的余地，毕竟这些是我这个不太挑剔的人都能直接发现的毛病。</p>

<p>整个手机的质感比较一般，很类似于多年前买的台电的mp3，从塑料到面板都很像，中国制造还需努力。当然，这也是一分价钱一分货，努比亚Z5S的接触材料的质感就比红米好多了。</p>

<p>此外，也用了下小米的rom软件，因为用的时间也不算长，主要只是教会老妈使用，感觉并不比中兴的强，可选的主题倒是比较多，但这个对我来讲确实不重要。</p>

<p>说了那么多不足，其实我还是很喜欢这个红米手机的。毕竟好处更多。只是说小米的好已经铺天盖地了，对于安卓的好处我也很认可，所以也就不再多说了。虽然是借助安卓和高通，但小米好歹是开创了属于中国的智能手机制造时代。还是很令人钦佩的。</p>

<p>最后，感概一下，形势还是比人强。我一直很讨厌双模双待，认为除了费电没有半分好处。然而，现在c网适合数据、gsm只适合电话的现实、以及有宽带必有c网流量，使得使用双卡已经变成一种很平常的行为。和我讨厌双网双待有一个最大的区别，彼时所谓双模只能用来打电话，而如今数据和电话确实已经是两种需求了。而且，数据业务确实基本不需要你告诉别人你的手机号。所以，c网数据、g网维持语音业务，也是当前比较合适的一种模式。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/16/dang-dai-zhong-guo-he-wei-lian-de-guo-de-ge-xiang-si-dian/">当代中国和威廉德国的一个相似点</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-16T15:15:00+08:00" pubdate data-updated="true">Mar 16<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>前一阵子有些媒体把崛起的中国比作同样是100多年前崛起的威廉德国。起初听到这种比喻，只觉得有点好笑。别的不说，如今风靡中国的BBA（奔驰 宝马 奥迪）都是威廉德国时代诞生的，就这几个跨世纪的杰出企业就是中国目前根本连门都摸不着的。至于发明家、工程师、企业家、科学家方面，那差距就不是一般的大了。中国可没有那么领先和尖端的人物和组织啊。而在军队方面，威廉拥有的德意志基石，普鲁士军队，恐怕我国能有一个营那样的队伍都很难。</p>

<p>但是，在看完了哈夫纳对俾斯麦德国和威廉德国的对比后，发现现在的中国有一点还真的和那时候的德国很类似。即国民的心态。</p>

<p>俾斯麦时期的德国人，并不认为自己的国家有多么先进。反而是崇拜法国人的东西。然而随着威廉时代的技术发展，尤其是内燃机取代蒸汽机时代的到来，诸如BBA、博世、西门子、克虏伯这些企业，他们在科学、技术、经济上都成为当时的领先者。而此时，整个国民的心态就一直水涨船高。民族的自信心由此加强。在这一点上，如今的中国和中国人确实走在相同的道路上。当然，我们相对于德国并非是有多么先进，而是在多上面做文章。虽然各方面均算不上最先进的，也无法领导潮流，但依靠体量和低成本的优势，在经济总量上确实实现了崛起。加之08年以来的欧美金融危机，使得中国式的东西一下子找回了曾经失去的信心。</p>

<p>就因为这种心态的变化，我们不再否认自己固有的一些东西，不管是好的还是坏的。也意识到老外的一套其实也并不那么先进，更不一定就是对我们的发展是好的。究竟是好是坏还很难讲，不过自信心的提高肯定是好事情。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/10/nubia-z5s/">Nubia Z5S</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-10T18:03:00+08:00" pubdate data-updated="true">Mar 10<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>作为多年电信号码的手机用户，现在用的手机也有一年半了，实在等不起LTE上市，所以决定还是继续买3G的手机。</p>

<p>电信版手机的选择限制还是比较多的。目标最后定在2k以内的国产手机，这样的选择无非是小米3 华为p6 努比亚等几种。一开始，想买小米3.正好过完年，米3的电信版也出来了。无奈抢了两次都没抢到，于是最后还是选到中兴华为的机型里面。</p>

<p>尽管p6的样子更好一些，但海思的芯片实在不讨人喜欢；而努比亚z5s的芯片倒是高通的旗舰，品质绝对有保障。最终，还是重视内在胜过了外观，选择买了z5s。</p>

<p>包装红白配，手机红黑配，设计倒是挺简洁的。
配件很节约，只有一个充电电源和一根充电线。但安卓好歹这么些年来，usb的接口都是一致的，所有的线都可以通用。比起水果一两年换个接口，明显更符合我的口味。
这个取卡针，不得不说和苹果真的很像。
单手持机的话，手感还是很轻巧的，整个重心控制的感觉很好。当然，5寸的屏幕还是大了些，操作起来就要双手了。响应等确实很快，顶配的CPU和大内存确实使得系统很流畅。</p>

<p>手机的背面。摄像头确实突起来一些，我个人倒不是很敏感这一点。贴纸有点山寨，过一阵打算揭掉。顺便提一下，这个贴纸写的cdma2000和wcdma手机，但手机本身又是所谓支持td-scdma的，所以显然写的有问题。</p>

<p>不想买micro-sim就是不想剪卡，但买了之后，发现其实剪卡只要掌握一定的门道就很简单。尤其是我这张3对6接触点的sim卡，那是相当的好剪。上面这个是要剪的卡，芯片所占面积本身就极小。</p>

<p>只要判断准自己的卡是3对6触点还是4对8触点，然后找相应的尺寸攻略，打好样后照着剪就万无一失了。
用铅笔打好样，直接剪好放进插槽即可。</p>

<p>之所以最早看中小米，是由于这3个里面，小米和努比亚都是支持全模，在国外也能用w的数据网络；华为的电信版在国外只能用语音。而华为的特色是双待，这一点和红米类似，但我只有一个号,双待对我而言意义不大。小米支持标准的sim卡（其实是mini-sim）而努比亚和p6都只能是小一点的micro-sim，外加电池好不少，这才让我起初倾向于小米3. 但一直买不到的感觉就不太好了，毕竟一个手机都买的这么累有点被厂商牵着鼻子走了。然而手机的选择还是很多的，所以试了2次之后决定转型，现在发觉nubia确实很不错。</p>

<p>鲁大师的跑分结果很高。高通的CPU果然不让人失望。</p>

<p>自从Google发布了安卓，中国手机厂商的春天就来了。虽然整个模式讲穿了只是之前HTC做过的那种：系统依靠移植，芯片主要也是依赖外部的，国产厂商主要做的还是一个集成加制造的活。但玩的比HTC有声有色的多。中国制造的性价比优势尽情展现。</p>

<p>尽管整体相当满意，但电池确实有点不太经用。这个2000ma出头的电池，如果整个下午都用qq聊天的话，基本上半天电就要用光了。所以，买这个机器移动电源最好是要配一个的。z5s的电池是不能随便更换的。自从用上智能手机后，我以前的手机上两块电板轮流用的机会也不太多了。目前比较方便的还是配个移动电源。</p>

<p>自从改用了C网，或者说自从智能手机开始普及，更换手机的频率一下子提高了。C网之前，老式的手机通常可以稳稳地用2年以上。而用上智能手机尤其是C网的智能手机后，更换频率基本在一年以内了。上一个华为8812还算是使用时间比较长的。不知道Nubia Z5S可以保鲜几年？</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/15/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/13/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2025/04/30/cong-bing-fa-dao-kotlinhe-mo-shi-de-xue-xi/">从并发到Kotlin和模式的学习</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/04/23/wfh-yi-ge-ban-yue/">WFH一个半月</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/12/30/2021-crvyang-che-cheng-ben-hui-zong/">2021 CRV养车成本汇总</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/10/26/the-kubernetes-book/">The Kubernetes Book</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/10/04/java-8-9-10-in-action/">Java 8 9 10 in action</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/技术'>技术 (96)</a></li><li><a href='/blog/categories/生活'>生活 (54)</a></li><li><a href='/blog/categories/车车'>车车 (40)</a></li><li><a href='/blog/categories/java'>Java (36)</a></li><li><a href='/blog/categories/读书笔记'>读书笔记 (26)</a></li><li><a href='/blog/categories/时评'>时评 (24)</a></li><li><a href='/blog/categories/神器'>神器 (23)</a></li><li><a href='/blog/categories/笔记'>笔记 (21)</a></li><li><a href='/blog/categories/ruby'>Ruby (18)</a></li><li><a href='/blog/categories/spring'>Spring (15)</a></li><li><a href='/blog/categories/项目管理'>项目管理 (14)</a></li><li><a href='/blog/categories/rails'>Rails (13)</a></li><li><a href='/blog/categories/linux'>Linux (12)</a></li><li><a href='/blog/categories/软考'>软考 (8)</a></li><li><a href='/blog/categories/云计算'>云计算 (6)</a></li><li><a href='/blog/categories/crv'>Crv (6)</a></li><li><a href='/blog/categories/nodejs'>Nodejs (6)</a></li><li><a href='/blog/categories/nosql数据库'>Nosql数据库 (5)</a></li><li><a href='/blog/categories/旅游'>旅游 (4)</a></li><li><a href='/blog/categories/管理'>管理 (4)</a></li><li><a href='/blog/categories/装机'>装机 (4)</a></li><li><a href='/blog/categories/heroku'>Heroku (4)</a></li><li><a href='/blog/categories/读书列表'>读书列表 (3)</a></li><li><a href='/blog/categories/git'>Git (3)</a></li><li><a href='/blog/categories/script'>Script (3)</a></li><li><a href='/blog/categories/mac'>Mac (2)</a></li><li><a href='/blog/categories/期刊'>期刊 (2)</a></li><li><a href='/blog/categories/外刊'>外刊 (2)</a></li><li><a href='/blog/categories/java'>Java (36)</a></li><li><a href='/blog/categories/键盘'>键盘 (1)</a></li><li><a href='/blog/categories/测试'>测试 (1)</a></li><li><a href='/blog/categories/安卓'>安卓 (1)</a></li><li><a href='/blog/categories/kotlin'>Kotlin (1)</a></li><li><a href='/blog/categories/区块链'>区块链 (1)</a></li><li><a href='/blog/categories/读书'>读书 (1)</a></li></ul>
</section>
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2025 - Hegel 2011 -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <a title="Web Statistics" href="http://getclicky.com/66623321"><img alt="Web Statistics" src="//static.getclicky.com/media/links/badge.gif" border="0" /></a>
  <script src="//static.getclicky.com/js" type="text/javascript"></script>
  <script type="text/javascript">try{ clicky.init(66623321); }catch(e){}</script>
  <noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/66623321ns.gif" /></p></noscript>

</p>

</footer>
  







<script type="text/javascript">
    (function() {
        var twitterWidgets = document.createElement('script');
        twitterWidgets.type = 'text/javascript';
        twitterWidgets.async = true;
        twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
        document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
</script>




</body>
</html>
